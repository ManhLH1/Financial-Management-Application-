// TEST SCRIPT: Kiểm tra xem có tạo nhiều spreadsheets không
// Run: node test-spreadsheet-creation.js

const GOOGLE_DRIVE_API = 'https://www.googleapis.com/drive/v3/files'

console.log('📋 HƯỚNG DẪN TEST:')
console.log('================')
console.log('')
console.log('1. MỞ BROWSER:')
console.log('   http://localhost:3000')
console.log('')
console.log('2. MỞ DEVTOOLS (F12):')
console.log('   - Console tab')
console.log('   - Network tab')
console.log('')
console.log('3. LOGIN VỚI GOOGLE')
console.log('')
console.log('4. QUAN SÁT LOGS TRONG TERMINAL:')
console.log('')
console.log('   ✅ SUCCESS (Chỉ tạo 1 file):')
console.log('   - 🔐 [getOrCreateSpreadsheet] Acquired lock for user@email.com')
console.log('   - ✅ Created new spreadsheet: [ID]')
console.log('   - 💾 Saved spreadsheet mapping')
console.log('   - ⏳ [getOrCreateSpreadsheet] Another request is waiting...')
console.log('   - ✅ [getOrCreateSpreadsheet] Got spreadsheet from concurrent request')
console.log('')
console.log('   ❌ FAIL (Tạo nhiều files):')
console.log('   - Thấy NHIỀU dòng "🔐 Acquired lock" cho cùng 1 user')
console.log('   - Thấy NHIỀU dòng "✅ Created new spreadsheet"')
console.log('')
console.log('5. CHECK GOOGLE DRIVE:')
console.log('   https://drive.google.com/drive/my-drive')
console.log('   - Search: "FinTrack"')
console.log('   - Chỉ nên thấy 1 file mới')
console.log('')
console.log('6. CHECK MAPPING FILE:')
console.log('   PowerShell: Get-Content .data\\spreadsheets.json | ConvertFrom-Json')
console.log('   Expected: { "your-email@gmail.com": "spreadsheet-id" }')
console.log('')
console.log('================')
console.log('🎯 KẾT QUẢ MONG ĐỢI:')
console.log('- Chỉ 1 file được tạo')
console.log('- Requests sau đợi request đầu tiên')
console.log('- Mapping file được tạo trong .data/')
console.log('- Không có errors về Deleted_Log sheet')
console.log('')
